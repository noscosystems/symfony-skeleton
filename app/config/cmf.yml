doctrine_cache:
    providers:
        phpcr_meta:
            type: file_system
        phpcr_nodes:
            type: file_system

doctrine_phpcr:
    odm:
        auto_mapping: true
        auto_generate_proxy_classes: "%kernel.debug%"
    session:
        backend:
            type: doctrinedbal
            # The following requires DoctrineCacheBundle, and providers
            # registered as services.
            caches:
                meta: doctrine_cache.providers.phpcr_meta
                nodes: doctrine_cache.providers.phpcr_nodes
            # Enable logging.
            logging: true
            # Enable profiling in the debug toolbar.
            profiling: true
        workspace: default
        username: admin
        password: admin

cmf_routing:
    chain:
        routers_by_id:
            cmf_routing.dynamic_router: 20
            router.default: 100
    dynamic:
        enabled: true
        persistence:
            phpcr:
                route_basepath: /cms/routes
                use_sonata_admin: false
        controllers_by_class:
            AppBundle\Document\Page: AppBundle\Controller\DefaultController::pageAction
            AppBundle\Document\Post: AppBundle\Controller\DefaultController::postAction

cmf_routing_auto:
    persistence:
        phpcr:
            enabled: true

sonata_block:
    default_contexts: [cms]
    blocks:
        # Enable the SonataAdminBundle block
        sonata.admin.block.admin_list:
            contexts: [admin]
        sonata_admin_doctrine_phpcr.tree_block:
            settings:
                id: '/cms'
            contexts: [admin]

sonata_admin:
    dashboard:
        blocks:
            - { position: left, type: sonata_admin_doctrine_phpcr.tree_block }
            - { position: right, type: sonata.admin.block.admin_list }

sonata_doctrine_phpcr_admin:
    document_tree_defaults: [locale]
    document_tree:
        AppBundle\Document\Site:
            valid_children:
                - all
        AppBundle\Document\Page:
            valid_children:
                - AppBundle\Document\Post
        AppBundle\Document\Post:
            valid_children: []
